// Create Argon2 instance with configured parameters

// Hash password with secure parameters

// Return encoded string (contains all metadata: algorithm, version, params, salt, hash)

// Verify by passing plain password and stored hash

// Argon2 library handles salt extraction automatically from encoded string

// Wipe Argon2 instance after use for security

```



\### 5. Update VictimAuthenticationService

File: src/main/java/com/group2/dbapp/service/VictimAuthenticationService.java



\*\*In register() method:\*\*

\- Replace SecurityUtils.hashPassword() call with new Argon2 implementation

\- Ensure password validation occurs before hashing

\- Confirm minimum password length requirement (currently 6 characters)

\- Verify email uniqueness check happens before hashing

\- Handle potential hashing exceptions gracefully



\*\*In login() method:\*\*

\- Replace hash comparison logic with SecurityUtils.verifyPassword()

\- Pass plain password and stored hash to verification method

\- Handle verification failures with appropriate error messages

\- Maintain existing session management logic

\- Handle potential verification exceptions



\### 6. Update AdminAuthenticationService

File: src/main/java/com/group2/dbapp/service/AdminAuthenticationService.java



\*\*In authenticate() method:\*\*

\- Replace hash comparison with SecurityUtils.verifyPassword()

\- Follow same pattern as VictimAuthenticationService

\- Ensure proper error handling for failed authentication

\- Handle potential verification exceptions



\### 7. Password Requirements Validation



Review and confirm in ValidationUtils.java:

\- Minimum password length: 6 characters (consider increasing to 8)

\- Maximum password length: reasonable limit for Argon2 processing (suggest 128 characters)

\- Character requirements: currently none (consider adding complexity rules)

\- Password strength feedback for users during registration



\### 8. New User Creation Flow Verification



\*\*Victim Registration (SignUpController -> VictimAuthenticationService):\*\*

1\. User enters name, email, password, confirm password

2\. Controller validates fields not empty and passwords match

3\. Service validates email format using ValidationUtils.isValidEmail()

4\. Service validates password length using ValidationUtils.isValidPassword()

5\. Service checks email uniqueness via VictimDAO.findByEmail()

6\. Service hashes password using SecurityUtils.hashPassword() with Argon2

7\. Service creates Victim object with hashed password

8\. DAO inserts record into Victims table with PreparedStatement

9\. New VictimID is auto-generated by database

10\. AccountStatus defaults to 'Active'

11\. DateCreated defaults to CURRENT\_TIMESTAMP

12\. Success confirmation shown to user



\*\*Confirm this flow is correct and secure:\*\*

\- No plain text passwords logged or stored

\- Database constraints prevent duplicate emails (UNIQUE constraint)

\- Password hash never exposed to client

\- Proper error handling at each step

\- SQL injection prevented via PreparedStatement



\### 9. Testing Requirements



After implementation, verify:

\- New victim registration creates valid Argon2 hash

\- Login works with newly created accounts

\- Admin login works with Argon2 hashes from PhishNet-inserts.sql

\- Password verification rejects incorrect passwords

\- Hash format is valid Argon2 encoded string (starts with $argon2id$)

\- Performance is acceptable (Argon2 is intentionally slow, should be under 1 second)

\- Database schema creates successfully from PhishNet-structure.sql

\- Initial data inserts successfully from PhishNet-inserts.sql



\### 10. Security Considerations



\*\*Ensure implementation addresses:\*\*

\- Timing attack prevention in verification (constant-time comparison)

\- Secure memory clearing after password processing

\- No password exposure in error messages

\- No password logging in any form

\- Protection against denial of service via excessive hashing

\- Argon2 instance cleanup (wipe method) after use

\- Exception handling doesn't leak sensitive information



\### 11. Configuration Parameters



\*\*Document recommended Argon2 parameters:\*\*

\- Type: Argon2id (hybrid of Argon2i and Argon2d for balanced security)

\- Iterations (time cost): 3 (number of iterations)

\- Memory cost: 65536 KB (64 MB) (memory usage)

\- Parallelism: 4 threads (degree of parallelism)

\- Salt length: 16 bytes (automatically handled by library)

\- Hash length: 32 bytes (automatically handled by library)



These parameters balance security and performance for desktop application. Argon2id provides protection against both side-channel attacks and GPU cracking attempts.



\### 12. Documentation Updates



\*\*Update the following documentation:\*\*

\- ARCHITECTURAL\_DESIGN.md: Update all references to DB\_SCHEMA\_V2.sql

\- ARCHITECTURAL\_DESIGN.md: Update Security Architecture section to reflect Argon2 usage

\- Add comments in PhishNet-structure.sql explaining table purposes

\- Add setup instructions indicating proper execution order



\## Deliverables



Provide complete, production-ready code for:



1\. \*\*Renamed PhishNet-structure.sql\*\* (formerly DB\_SCHEMA\_V2.sql)

&nbsp;  - Schema definition only

&nbsp;  - No INSERT statements

&nbsp;  - Clean, well-commented structure

&nbsp;  - Reference to PhishNet-inserts.sql at the end



2\. \*\*New PhishNet-inserts.sql\*\*

&nbsp;  - Administrator data with Argon2 hashes

&nbsp;  - Clear comments documenting password

&nbsp;  - ON DUPLICATE KEY UPDATE clause

&nbsp;  - Proper USE database statement



3\. \*\*Updated SecurityUtils.java\*\*

&nbsp;  - Complete Argon2 implementation

&nbsp;  - Remove SHA-256 methods

&nbsp;  - JavaDoc comments

&nbsp;  - Proper exception handling



4\. \*\*Updated VictimAuthenticationService.java\*\*

&nbsp;  - Argon2 hashing in register()

&nbsp;  - Argon2 verification in login()

&nbsp;  - Exception handling



5\. \*\*Updated AdminAuthenticationService.java\*\*

&nbsp;  - Argon2 verification in authenticate()

&nbsp;  - Exception handling



6\. \*\*Updated ARCHITECTURAL\_DESIGN.md\*\*

&nbsp;  - File name references

&nbsp;  - Security section updates

&nbsp;  - Argon2 parameter documentation



\## Code Quality Requirements



\- Follow existing code style and conventions

\- Include proper exception handling

\- Add JavaDoc comments for public methods

\- Maintain compatibility with Java 17

\- Ensure thread safety if applicable

\- No breaking changes to existing API contracts

\- Use try-with-resources for Argon2 instances

\- Clear variable naming

\- Comprehensive error messages



\## Schema Validation Checklist



Confirm the following about the current schema:

\- Victims table correctly represents normal users (reporters/victims of attacks)

\- PasswordHash VARCHAR(255) is sufficient for Argon2 output (encoded string is typically 96-120 characters)

\- All foreign key constraints are properly defined with correct references

\- Cascade rules prevent orphaned records (ON DELETE CASCADE where appropriate)

\- ENUM values match application logic and proposal document

\- Default values are appropriate (Active, UnderReview, Pending, etc.)

\- Unique constraints on email fields prevent duplicates

\- Auto-increment primary keys properly configured

\- Datetime fields use CURRENT\_TIMESTAMP where appropriate



Provide feedback on any schema issues discovered and suggest corrections.



\## File Organization



Final structure should be:

```

project-root/

├── PhishNet-structure.sql    (renamed from DB\_SCHEMA\_V2.sql - schema only)

├── PhishNet-inserts.sql       (new file - initial data with Argon2 hashes)

├── src/main/java/com/group2/dbapp/

│   ├── util/

│   │   └── SecurityUtils.java (updated with Argon2)

│   └── service/

│       ├── VictimAuthenticationService.java (updated)

│       └── AdminAuthenticationService.java (updated)

└── ARCHITECTURAL\_DESIGN.md (updated references)

